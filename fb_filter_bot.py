from telegram.ext import ApplicationBuilder, MessageHandler, filters, ContextTypes
from telegram import Update

# 🪖 قائمة الكلمات المحظورة - موسعة شلع
banned_words = [
    # سياسية وطائفية وأمنية
    "قاسم سليماني", "ابو مهدي المهندس", "حسن نصرالله", "عماد مغنية", "جهاد مغنية",
    "اسماعيل قاآني", "ابو علي العسكري", "ابو فدك", "ابو ولاء الولائي", "السيد هاشم صفي الدين",
    "حزب الله", "كتائب حزب الله", "عصائب اهل الحق", "سرايا السلام", "الجهاد الاسلامي",
    "سرايا القدس", "كتائب القسام", "حماس", "داعش", "القاعدة", "تنظيم الدولة", "طالبان",
    "انصار الله", "ولاية الفقيه", "مرجعية", "الجهاد", "المقاومة", "مقاومة", "مجاهد", "مجاهدين",
    "قتال", "قتل", "استشهاد", "شهيد", "شهداء", "تفجير", "انفجار", "عبوة", "عبوات", "مسلح",
    "مسلحين", "مسلحة", "سلاح", "اسلحة", "مسدس", "قناص", "قنص", "صاروخ", "صواريخ", "قنبلة",
    "قنابل", "عملية استشهادية", "عملية نوعية", "عملية جهادية", "مفخخة", "طائرة مسيرة", "مسيرة",
    "اطلاق نار", "اشتباك", "رصاص", "حزام ناسف", "ملغمة", "لغم", "ناسفة", "مفخخ", "دكة", "ثأر",
    "ثائر", "نحر", "اعدام", "اغتيال", "تصفية", "مجزرة", "قتل جماعي", "جريمة", "ارهابي", "ارهاب",
    "تهجم", "تهديد", "حاصر", "سحل", "استهدف", "حرب", "الاحتلال", "المحتل", "الصهاينة",
    "صهيوني", "الكيان الصهيوني", "العدو الصهيوني", "الشيطان الاكبر", "الكيان المحتل",
    "العدو الامريكي", "احراق العلم", "سني", "سنيه", "سنيين", "شيعي", "شيعية", "شيعيين",
    "رافضي", "رافضة", "ناصبي", "ناصبة", "صفوي", "تكفيري", "وهابي", "زيدي", "جعفري", "مذهب",
    "مذهبي", "طائفة", "طائفية", "اهل السنة", "اهل الشيعة",
    # باللهجة العراقية والأمنية
    "كتل", "كتله", "كتلوني", "صجم", "ملغمة", "لغم", "خطية", "فصلية", "عشيرة", "عشائري", "نحر",
    "حزام ناسف", "ثار", "ثأر", "تار", "حرب", "مقتول", "دم", "دماء", "مجروح", "جرح", "هجوم",
    "كمين", "اطلاق", "خطف", "مجزرة", "شهيد", "شهداء", "استشهاد",
    # كلمات جنسية وإيحاءات
    "جنس", "جنسي", "جنسية", "سكس", "سيكس", "نيك", "زب", "طيز", "كس", "قحبة", "عاهرة",
    "دعارة", "لوطي", "لواط", "سحاق", "اغتصاب", "خنثى", "حلمات", "صدر", "مؤخرة", "قذف",
    "شهوة", "عار", "عري", "عارية", "عاريا", "مداعبة", "علاقات جنسية", "علاقة جنسية",
    "ممارسة", "مثلي", "مثلية", "شاذ", "شاذة", "اباحية", "افلام اباحية", "افلام سكس",
    # سب وشتم باللهجة العراقية
    "كلب", "حيوان", "تافه", "قذر", "زبالة", "ابن الكلب", "ابن العاهرة", "ابن القحبة",
    "ابن الزنا", "ابن الحرام", "نذل", "وضيع", "عرص", "منحرف", "غبي", "معوق", "احول",
    "عور", "معفن", "طرطور", "ابكم", "احمار", "حمير", "تفو", "طيح الله حظك", "طيح حظك",
    "طيح الله حظ", "طيح حظ", "زرب", "طرطعان", "ولك", "انعل ابو", "انعل والديك", "يا حيوان",
    "يا تافه", "يا غبي", "قحبة", "عاهرة", "مطي", "منيوك", "قواد", "عاهره", "كس اختك",
    "نيج", "قحبه", "انيجك", "انعل", "ابن القحبه", "ابو القحبه", "ولد القحبه",
    # الرقم المطلوب سابقاً
    "126789"
]

# 🪄 دالة الفلترة
def smart_censor(text):
    for word in banned_words:
        if word in text:
            parts = word.split()
            modified_parts = []
            for part in parts:
                if len(part) > 1:
                    modified_part = part[0] + "ـ.ـ" + part[1:]
                else:
                    modified_part = part
                modified_parts.append(modified_part)
            modified_word = ' '.join(modified_parts)
            text = text.replace(word, modified_word)
    return text

async def handle_message(update: Update, context: ContextTypes.DEFAULT_TYPE):
    text = update.message.text
    cleaned_text = smart_censor(text)
    await update.message.reply_text(cleaned_text)

def main():
    app = ApplicationBuilder().token("8001794158:AAHSB4-RXsOIhfUEABeal1M4cMHmRlnHk7A").build()
    app.add_handler(MessageHandler(filters.TEXT & (~filters.COMMAND), handle_message))
    app.run_polling()

if __name__ == '__main__':
    main()
